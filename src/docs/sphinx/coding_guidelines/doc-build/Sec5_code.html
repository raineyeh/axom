<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>5 General Code Development &mdash; Toolkit Coding Guidelines 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Toolkit Coding Guidelines 1.0 documentation" href="index.html" />
    <link rel="next" title="6 Class Design and Implementation" href="Sec6_class.html" />
    <link rel="prev" title="4 Code Documentation" href="Sec4_doc.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="Sec6_class.html" title="6 Class Design and Implementation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="Sec4_doc.html" title="4 Code Documentation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Toolkit Coding Guidelines 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="general-code-development">
<h1>5 General Code Development<a class="headerlink" href="#general-code-development" title="Permalink to this headline">¶</a></h1>
<p>This section contains various development guidelines intended to improve code
readability, correctness, portability, consistency, and robustness.</p>
<div class="section" id="general-design-and-implementation-considerations">
<h2>5.1 General design and implementation considerations<a class="headerlink" href="#general-design-and-implementation-considerations" title="Permalink to this headline">¶</a></h2>
<p>5.1.1 Simplicity, clarity, ease of modification and extension <strong>should</strong> always be a main goal when writing new code or changing existing code.</p>
<p>5.1.2 All designs and implementations <strong>should</strong> be reviewed with other team members and refined based on input from others.</p>
<blockquote>
<div>This is especially important for designs that are complex or potentially
unclear. What cannot be easily understood cannot be changed and
maintained with confidence.</div></blockquote>
<p>5.1.3 Each entity (class, struct, variable, function, etc.) <strong>should</strong> embody one clear, well-defined concept.</p>
<blockquote>
<div>The responsibilities of an entity may increase as it is used in new and
different ways. However, changes that divert it from its original intent
<strong>should</strong> be avoided. Also, large, monolithic entities that provide too
much functionality or which include too many concepts tend to increase
code coupling and complexity and introduce undesirable side effects.
Smaller, clearly constrained objects are easier to write, test, maintain,
and use correctly. Also, small, simple objects tend to get used more often
and reduce code redundancy. Designs and implementations that are overly
complexity should be evaluated by the team and modified appropriately.</div></blockquote>
<p>5.1.4 Global, complex, or opaque data sharing <strong>should</strong> be avoided. Shared data increases coupling and contention between different parts of a code base, which makes maintenance and modification difficult.</p>
<p>5.1.5 When making substantial modifications or stylistic changes to existing code, an attempt <strong>should</strong> be made to make all other code, for example in a source file, consistent with the changes.</p>
</div>
<div class="section" id="code-robustness">
<h2>5.2 Code robustness<a class="headerlink" href="#code-robustness" title="Permalink to this headline">¶</a></h2>
<p>5.2.1 The &#8220;const&#8221; qualifier <strong>should</strong> be used for variables and methods when appropriate to clearly indicate usage and to take advantage of compiler-based error-checking.</p>
<blockquote>
<div>Constant declarations make code safer and less error-prone since they
enforce intent at compile time. They also simplify code understanding
because a constant declaration clearly indicates the fact that the state
of a variable or object will not change in the scope in which the
declaration appears.</div></blockquote>
<p>5.2.2 Preprocessor macros <strong>should not</strong> be used when there is a better alternative, such as an inline function or a constant variable definition.</p>
<blockquote>
<div><p>For example, this:</p>
<div class="highlight-python"><div class="highlight"><pre>const double PI = 3.1415926535897932384626433832;
</pre></div>
</div>
<p>is preferable to this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#define PI (3.1415926535897932384626433832)</span>
</pre></div>
</div>
<p>Macros circumvent the ability of a compiler to enforce beneficial
language concepts such as scope and type safety. Macros are also
context-specific and can produce errors that cannot be understood
easily in a debugger. Macros <strong>should be used only</strong> when they are the
best choice for a particular situation.</p>
</div></blockquote>
<p>5.2.3 An enumeration type <strong>should</strong> be used instead of macro definitions or &#8220;int&#8221; data for sets of related constant values.</p>
<blockquote>
<div>In C++, enums are distinct types with a compile-time specified set of
values. Enumeration values cannot be implicitly cast to integers or
vice versa &#8211; a &#8220;static_cast&#8221; operator must be used to make the
conversion explicit. Thus, enums provide type and value safety and
scoping benefits.</div></blockquote>
<p>5.2.4 Hard-coded numerical constants and other &#8220;magic numbers&#8221; <strong>must not</strong> be used directly in code. When such values are needed, they <strong>should</strong> be declared as named constants to enhance code readability and consistency.</p>
<p>5.2.5 Floating point constants <strong>should</strong> always be written with a decimal point and have at least one digit before and after the decimal point for clarity.</p>
<blockquote>
<div>For example, use &#8220;0.5&#8221; instead of &#8221;.5&#8221; and &#8220;1.0&#8221; instead of &#8220;1&#8221; or &#8220;1.&#8221;.</div></blockquote>
</div>
<div class="section" id="compilation-and-portability">
<h2>5.3 Compilation and portability<a class="headerlink" href="#compilation-and-portability" title="Permalink to this headline">¶</a></h2>
<p>5.3.1 All C-only files <strong>must</strong> contain only standard C99 usage. Use of standard C11 features <strong>must</strong> be agreed upon by the project team and be guarded in the code using the &#8220;USE_C11&#8221; compiler generated macro constant.</p>
<blockquote>
<div>Changing this guideline requires full concensus of all team members.</div></blockquote>
<p>5.3.2 All C++ files <strong>must</strong> contain only standard C++03 usage. Use of standard C++11 or C++14 features <strong>must</strong> be agreed upon by the project team. If C++11 standard features are introduced, they <strong>must</strong> be guarded in the code using the &#8220;USE_CXX11&#8221; compiler generated macro constant.</p>
<blockquote>
<div>Changing this guideline requires full concensus of all team members.</div></blockquote>
<p>5.3.3 Special non-standard language constructs, such as GNU extensions, <strong>must not</strong> be used if they hinder portability.</p>
<p>5.3.4 Excessive use of the preprocessor for conditional compilation at a fine granularity (e.g., selectively including or removing individual source lines) <strong>should</strong> be avoided.</p>
<blockquote>
<div>While it may seem convenient, this practice typically produces confusing
and error-prone code. Often, it is better to refactor the code into
separate routines or large code blocks subject to conditional compilation
where it is obvious. The team <strong>should</strong> establish a policy policy for
how this is done.</div></blockquote>
<p>5.3.5 Developers <strong>should</strong> rely on compile-time and link-time errors to check for code correctness and invariants.</p>
<blockquote>
<div>Errors that occur at run-time and which depend on specific control flow
and program state are inconvenient for users and can be difficult to
detect and fix.</div></blockquote>
<p>5.3.6 Before committing code to the source repository, developers <strong>must</strong> attempt to compile cleanly at the highest warning level with the main compiler(s) supported by the project. All warnings <strong>must</strong> be understood and eliminated if possible (not by reducing the warning level!).</p>
<blockquote>
<div>Compiler warnings, while seemingly innocuous at times, often indicate
problems that do not appear until later or until specific run-time
conditions are encountered.</div></blockquote>
</div>
<div class="section" id="memory-management">
<h2>5.4 Memory management<a class="headerlink" href="#memory-management" title="Permalink to this headline">¶</a></h2>
<p>5.4.1 Memory <strong>should</strong> be deallocated in the same scope in which it is allocated.</p>
<p>5.4.2 Memory <strong>should</strong> be deallocated as soon as it is no longer needed.</p>
<p>5.4.3 Pointers <strong>should</strong> be set to null explicitly when memory is deallocated. Since we have not yet moved to C++11, this <strong>must</strong> be done using &#8220;NULL&#8221;.</p>
<p>5.4.4 Data managed exclusively within C++ code <strong>must</strong> be allocated and deallocated using the &#8220;new&#8221; and &#8220;delete&#8221; operators.</p>
<blockquote>
<div>The operator &#8220;new&#8221; is type-safe, simpler to use, and less error-prone
than the &#8220;malloc&#8221; family of C functions.  C++ new/delete operators
<strong>must not</strong> be combined with C malloc/free functions.</div></blockquote>
<p>5.4.5 Every C++ array deallocation statement <strong>must</strong> include &#8220;[ ]&#8221; (i.e., &#8220;delete[ ]&#8221;) to avoid memory leaks.</p>
<blockquote>
<div>The rule of thumb is: when &#8220;[ ]&#8221; appears in the allocation, then &#8220;[ ]&#8221;
<strong>must</strong> appear in the corresponding deallocation statement.</div></blockquote>
<p>5.4.6 Before committing code to the source repository, one <strong>should</strong> use memory-checking tools to verify there are no leaks and other memory misuse.</p>
<blockquote>
<div>When merging to the <em>develop</em> or <em>master</em> branches, compilation with a
variety fo compilers, testing, memory-checking, etc. will be done
automatically as part of the <em>pull request</em> approval process.  The pull
request will not be approved until all of these tasks succeed.</div></blockquote>
</div>
<div class="section" id="function-declarations">
<h2>5.5 Function declarations<a class="headerlink" href="#function-declarations" title="Permalink to this headline">¶</a></h2>
<p>5.5.1 Any class member function that does not change a data member of the associated class <strong>must</strong> be declared &#8220;const&#8221;.</p>
<p>5.5.2 Function arguments <strong>must</strong> be ordered the same way for all routines in a project.</p>
<blockquote>
<div>Common conventions are either to put all input arguments first, then
outputs, or the other way around. Input and output and outputs
<strong>must not</strong> be mixed in a function signature. Parameters that are both
input and output can make the best choice unclear. Conventions consistent
with relatd functions <strong>must</strong> always be followed. When adding new
parameters to an existing method, the established ordering convention
<strong>must</strong> be followed. Do not just stick new parameters at the end of
the argument list.</div></blockquote>
<p>5.5.3 Each function argument that is not a built-in type (i.e., int, double, char, etc.) <strong>should</strong> be passed either by reference or as a pointer to avoid unnecessary copies.</p>
<p>5.5.4 Each function reference or pointer argument that is not changed by the function <strong>must</strong> be declared &#8220;const&#8221;.</p>
<p>5.5.6 Variable argument lists (i.e., using ellipses &#8221;...&#8221;) <strong>should</strong> be avoided.</p>
<blockquote>
<div>Although this is a common practice in C code, and can be done in C++ code,
this is typically considered a dangerous carryover from C. Variadic
functions are not type-safe and they require tight coupling between
caller and callee, and can result in undefined behavior.</div></blockquote>
<p>5.5.7 Each argument in a function declaration <strong>must</strong> be given a name that exactly matches the function implementation.</p>
<blockquote>
<div><p>For example, use:</p>
<div class="highlight-python"><div class="highlight"><pre>void computeSomething(int op_count, int mode);
</pre></div>
</div>
<p>not:</p>
<div class="highlight-python"><div class="highlight"><pre>void computeSomething(int, int);
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="function-implementations">
<h2>5.6 Function implementations<a class="headerlink" href="#function-implementations" title="Permalink to this headline">¶</a></h2>
<p>5.6.1 Each function body <strong>should</strong> be a reasonable length to be easily understood and viewed in a text editor. Long, complex routines <strong>should</strong> be refactored into smaller parts when this is reasonable to increase clarity, flexibility, and the potential for code reuse.</p>
<p>5.6.2 Each function <strong>should</strong> have exactly one return point to make control logic clear.</p>
<blockquote>
<div><p>Functions with multiple return points tend to be a source of errors when
modifying code. Such routines can always be refactored to have a single
return point by using local scope boolean variables and/or different
control logic.</p>
<p>A function <strong>may</strong> have two return points if the first return statement
is associated with error condition check, for example. In this case,
the error check <strong>should</strong> be performed at the start of the function body
before other statements are reached. For example, the following is a
reasonable use of two function return points because the error condition
check and the return value for successful completion are clearly visible:</p>
<div class="highlight-python"><div class="highlight"><pre>int computeSomething(int in_val)
{
   if (in_val &lt; 0) { return -1; }

   // ...rest of function implementation...

   return 0;
}
</pre></div>
</div>
</div></blockquote>
<p>5.6.3 &#8220;Sanity checks&#8221; should be performed on values of function arguments (e.g., range checking, null pointer checking, etc.) upon entry to a function.</p>
<blockquote>
<div><p>This is an excellent way to provide run-time debugging capabilities in
code. Currently, we have a set of <em>assertion</em> macros to make syntax
consistent. When triggered, they can emit a failed boolean expression and
descriptive message that help to understand the violation. They are
active or not based on the compilation mode, either debug (active) or
optimized (inactive). For example:</p>
<div class="highlight-python"><div class="highlight"><pre>void doSomething(int in_val, Foo* in_foo)
{
   ATK_ASSERT_MSG( in_val &gt;= 0, &quot;in_val must be positive or zero&quot; );
   ATK_ASSERT( in_foo != NULL );

   // ...function implementation...
}
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="inline-functions">
<h2>5.7 Inline functions<a class="headerlink" href="#inline-functions" title="Permalink to this headline">¶</a></h2>
<p>Function inlining is a compile time operation and the full definition of an
inline function must be seen wherever it is called. Thus, any function to be
inlined must be implemented in a header file.</p>
<p>When a function is implemented in a header file, but not declared inline, a
compiler will choose whether or not to inline the function. Typically,
a compiler will not inline a function that is too long or too complex (e.g.,
if it contains complicated conditional logic). When a compiler inlines a
function, it replace the function call with the body of the function. Most
modern ccompilers do a good job of deciding when inlining is a good choice.</p>
<p><strong>Important notes:</strong></p>
<blockquote>
<div><ul class="simple">
<li>When a function implementation appears in a header file, every file that
uses that inline method will often also emit a <em>function version</em> of the
method in the object file (*.o file). This is needed to properly
support function pointers.</li>
<li>When a function is explicitly declared inline, using the &#8220;inline&#8221; keyword,
the compiler still decides whether to inline the function. It is possible to
specify function attributes and compiler flags that will force a compiler to
inline a function. Excessive inlining can cause executable code bloat and
may make debugging dificult. Thus, care must be used when deciding which
functions to explicitly declare inline.</li>
</ul>
</div></blockquote>
<p><strong>When in doubt, don&#8217;t use the &#8220;inline&#8221; keyword and let the compiler decide whether to inline a function.</strong></p>
<p>5.7.1 Simple, short frequently called functions, such as accessors, <strong>should</strong> be implemented inline in header files in most cases.</p>
<blockquote>
<div><p><strong>Exception:</strong> Most accessors that return an object by value (i.e., not by
pointer or a reference) <strong>should not</strong> be inlined. For example:</p>
<div class="highlight-python"><div class="highlight"><pre>clas MyData
{
   // ...public interface...
private:
   // non-trivial private data members
   vector&lt;Foo&gt; m_foovec;
   Bar m_bar;
};

class MyClass
{
publis:
   //...
   MyData getData() { return m_mydata; }

private:
   MyData m_mydata;
};
</pre></div>
</div>
</div></blockquote>
<p>5.7.2 Class constructors <strong>should not</strong> be inlined.</p>
<blockquote>
<div><p>A class constructor implicitly calls the constructors for its base
classes and initializes some or all of its data members, potentially
calling more constructors. If a constructor is inlined, the construction
and initialization needed for its members and bases will appear at every
object declaration.</p>
<p><strong>Exception:</strong> The only case where it is reasonable to inline a
constructor is when it has only POD (&#8220;plain old data&#8221;) mambers, is not a
subclass of a base class, and does not explcitly declare a destructor.
In this case, a compiler will not even generate a destructor in most
cases. For example:</p>
<div class="highlight-python"><div class="highlight"><pre>class MyClass
{
public:
   MyClass() : m_data1(0), m_data2(0) { }

   // No destructor declared

   // ...rest of class definition...
private:
   // class has only POD members
   int m_data1;
   int m_data2;
};
</pre></div>
</div>
</div></blockquote>
<p>5.7.3 Virtual functions <strong>must not</strong> be inlined due to polymorphism.</p>
<blockquote>
<div><p>For example, do not declare a virtual class member function as:</p>
<div class="highlight-python"><div class="highlight"><pre>virtual void foo( ) { }
</pre></div>
</div>
<p>In most circumstances, a virtual method cannot be inlined even though it
would be inlined otherwise (e.g., because it is very short). A compiler
must do runtime dispatch on a virtual method when it doesn&#8217;t know the
complete type at compile time.</p>
<p><strong>Exception:</strong> It is safe to define an empty destructor inline in an
abstract base class with no data members. For example:</p>
<div class="highlight-python"><div class="highlight"><pre>class MyBase
{
public:
   virtual ~MyBase() {}

   virtual void doSomething(int param1) = 0;

   virtual void doSomethingElse(int param2) = 0;

   // ...

   // ...no data members...
};
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="function-and-operator-overloading">
<h2>5.8 Function and operator overloading<a class="headerlink" href="#function-and-operator-overloading" title="Permalink to this headline">¶</a></h2>
<p>5.8.1 Functions with the same name <strong>must</strong> differ in their argument lists and/or in their &#8220;const&#8221; attribute.</p>
<blockquote>
<div>C++ does not allow identically named functions to differ only in their
return type since it is always the option of the caller to ignore or use
the function return value.</div></blockquote>
<p>5.8.2 Function overloading <strong>must not</strong> be used to define functions that do conceptually different things.</p>
<blockquote>
<div>Someone reading declarations of overloaded functions should be able to
assume (and rightfully so!) that functions with the same name do
something very similar.</div></blockquote>
<p>5.8.3 If an overloaded virtual method in a base class is overridden in a derived class, all overloaded methods with the same name in the base class <strong>must</strong> be overridden in the derived class.</p>
<blockquote>
<div>This prevents unexpected behavior when calling such member functions.
Remember that when a virtual function is overridden, the overloads of
that function in the base class <strong>are not visible</strong> to the derived class.</div></blockquote>
<p>5.8.4 Operator overloading <strong>must not</strong> be used to be clever to the point of obfuscation and cause others to think too hard about an operation. Specifically, an overloaded operator must preserve &#8220;natural&#8221; semantics by appealing to common conventions and <strong>must</strong> have meaning similar to non-overloaded operators of the same name.</p>
<blockquote>
<div>Overloading operators can be beneficial, but <strong>should not</strong> be overused
or abused. Operator overloading is essentially &#8220;syntactic sugar&#8221; and an
overloaded operator is just a function like any other function. An
important benefit of overloading is that it often allows more
appropriate syntax that more easily communicates the meaning of an
operation. The resulting code can be easier to write, maintain, and
understand, and it may be more efficient since it may allow the compiler
to take advantage of longer expressions than it could otherwise.</div></blockquote>
<p>5.8.5 Both boolean operators &#8220;==&#8221; and &#8221;!=&#8221; <strong>should</strong> be implemented if one of them is.</p>
<blockquote>
<div><p>For consistency and correctness, the &#8221;!=&#8221; operator <strong>should</strong> be
implemented using the &#8220;==&#8221; operator implementation. For example:</p>
<div class="highlight-python"><div class="highlight"><pre>bool MyClass::operator!= (const MyClass&amp; rhs)
{
   return !(this == rhs);
}
</pre></div>
</div>
</div></blockquote>
<p>5.8.6 Standard operators, such as &#8220;&amp;&amp;&#8221;, &#8220;||&#8221;, and &#8221;,&#8221; (i.e., comma), <strong>must not</strong> be overloaded.</p>
<blockquote>
<div>The built-in versions are treated specially by the compiler. Thus,
programmers cannot implement their full semantics. This can cause
confusion. For example, the order of operand evaluation cannot be
guaranteed when overloading operators &#8220;&amp;&amp;&#8221; or &#8220;||&#8221;. This may cause
problems as someone may write code that assumes that evaluation order
is the same as the built-in versions.</div></blockquote>
</div>
<div class="section" id="types">
<h2>5.9 Types<a class="headerlink" href="#types" title="Permalink to this headline">¶</a></h2>
<p>5.9.1 Behavior <strong>should not</strong> be selected by &#8220;switching&#8221; on the type of an
object.</p>
<blockquote>
<div>Good object-oriented design uses virtual functions (or templates) to
decide behavior. Using conditional logic (e.g., in calling code) to
decide behavior is often unsafe and error-prone, and a clear indication
of poor design and improper use of the C++ type system.</div></blockquote>
<p>5.9.2 The &#8220;bool&#8221; type <strong>should</strong> be used in C++ code instead of &#8220;int&#8221; for boolean true/false values.</p>
<p>5.9.3 The &#8220;string&#8221; type <strong>should</strong> be used in C++ code instead of &#8220;char*&#8221;.</p>
<blockquote>
<div>The string type supports and optimizes many character string manipulation
operations which can be error-prone and less efficient if implemented
explicitly using &#8220;char*&#8221; and standard C library functions. Note that
&#8220;string&#8221; and &#8220;char*&#8221; types are easily interchangeable, which allows C++
string data to be used when interacting with C routines.</div></blockquote>
<p>5.9.4 Class type variables <strong>should</strong> be defined using direct initialization instead of copy initialization to avoid unwanted and spurious type conversions and constructor calls that may be generated by compilers.</p>
<blockquote>
<div><p>For example, use:</p>
<div class="highlight-python"><div class="highlight"><pre>std::string name(&quot;Bill&quot;);
</pre></div>
</div>
<p>instead of:</p>
<div class="highlight-python"><div class="highlight"><pre>std::string name = &quot;Bill&quot;;
</pre></div>
</div>
<p>or:</p>
<div class="highlight-python"><div class="highlight"><pre>std::string name = std::string(&quot;Bill&quot;);
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="type-casting">
<h2>5.10 Type casting<a class="headerlink" href="#type-casting" title="Permalink to this headline">¶</a></h2>
<p>5.10.1 C-style casts <strong>must not</strong> be used in C++ code.</p>
<blockquote>
<div>All type conversions <strong>must</strong> be done explicitly using the named C++
casting operators; i.e., &#8220;static_cast&#8221;, &#8220;const_cast&#8221;, &#8220;dynamic_cast&#8221;,
&#8220;reinterpret_cast&#8221;.</div></blockquote>
<p>5.10.2 The choice to use the &#8220;static_cast&#8221; or &#8220;dynamic_cast&#8221; operator on pointers <strong>must</strong> consider the performance context of the code.</p>
<blockquote>
<div>The &#8220;dynamic_cast&#8221; operator is a more powerful and safer way to cast
pointers. However, in performance critical code, dynamic cast overhead
may be unacceptable. Static casts are done at compile time and are
essentially free at runtime whereas each dynamic cast may incur hundreds        of cycles of runtime overhead. When this choice is encountered, it may
be wise to consider other implementation alternatives.</div></blockquote>
<p>5.10.3 The &#8220;const_cast&#8221; operator <strong>should</strong> be avoided.</p>
<blockquote>
<div><p>Casting away &#8220;const-ness&#8221; is often a poor programming decision and can
introduce errors.</p>
<p><strong>Exception:</strong> It may be necessary in some circumstances to cast away
const-ness, such as when calling const-incorrect APIs.</p>
</div></blockquote>
<p>5.10.4 The &#8220;reinterpret_cast&#8221; <strong>must not</strong> be used unless absolutely necessary.</p>
<blockquote>
<div>This operator was designed to perform a low-level reinterpretation of
the bit pattern of an operand. This is needed only in special
circumstances and circumvents type safety.</div></blockquote>
</div>
<div class="section" id="templates">
<h2>5.11 Templates<a class="headerlink" href="#templates" title="Permalink to this headline">¶</a></h2>
<p>5.11.1 Typically, a class (or function) template <strong>should</strong> be used only when the behavior of the class (or function) is completely independent of the type of the object to which it is applied.</p>
<blockquote>
<div>Note that class member templates (e.g., member functions that are
templates of a class that is not a template) are often useful to
reduce code redundancy.</div></blockquote>
<p>5.11.2 Generic templates that have external linkage <strong>must</strong> be defined in the header file where they are declared since template instantiation is a compile time operation. Thus, implementations of class templates and member templates <strong>must</strong> be placed in the class header file, preferably after the class definition.</p>
<p>5.11.3 Complete specializations of member templates or function templates <strong>must not</strong> appear in a header file.</p>
<blockquote>
<div>Such methods <strong>are not templates</strong> and may produce link errors if their
definitions are seen more than once.</div></blockquote>
</div>
<div class="section" id="conditional-statements-and-loops">
<h2>5.12 Conditional statements and loops<a class="headerlink" href="#conditional-statements-and-loops" title="Permalink to this headline">¶</a></h2>
<p>5.12.1 Curly braces <strong>must</strong> be used in all conditionals, loops, etc. even when the content inside the braces is a &#8220;one-liner&#8221;.</p>
<blockquote>
<div><p>This helps prevent coding errors and misinterpretation of intent.
For example, use:</p>
<div class="highlight-python"><div class="highlight"><pre>if (done) { ... }
</pre></div>
</div>
<p>not:</p>
<div class="highlight-python"><div class="highlight"><pre>if (done) ...
</pre></div>
</div>
</div></blockquote>
<p>5.12.2 One-liners <strong>may</strong> not be used for &#8220;if&#8221; conditionals with &#8220;else/else if&#8221;  clauses when the resulting code is clear.</p>
<blockquote>
<div><p>For example, either of the following styles <strong>may</strong> be used:</p>
<div class="highlight-python"><div class="highlight"><pre>if (done) {
   id = 3;
} else {
   id = 0;
}
</pre></div>
</div>
<p>or:</p>
<div class="highlight-python"><div class="highlight"><pre>if (done) { id = 3; } else { id = 0; }
</pre></div>
</div>
</div></blockquote>
<p>5.12.3 For clarity, the shortest block of an &#8220;if/else&#8221; statement <strong>should</strong> come first.</p>
<p>5.12.4 Complex &#8220;if/else if&#8221; conditionals with many &#8220;else if&#8221; clauses <strong>should</strong> be avoided.</p>
<blockquote>
<div>Such statements can always be refactored using local boolean variables
or &#8220;switch&#8221; statements. Doing so often makes code easier to read and
understand and may improve performance.</div></blockquote>
<p>5.12.5 An explicit test for zero/nonzero <strong>must</strong> be used in a conditional unless the tested quantity is a bool or a pointer.</p>
<blockquote>
<div><p>For example, a conditional based on an integer value should use:</p>
<div class="highlight-python"><div class="highlight"><pre>if (num_lines != 0) {
</pre></div>
</div>
<p>not:</p>
<div class="highlight-python"><div class="highlight"><pre>if (num_lines) {
</pre></div>
</div>
</div></blockquote>
<p>5.12.6 A switch statement <strong>should</strong> use curly braces for each case and use indentation, white space, and comments for readability. Also, each case <strong>must</strong> contain a &#8220;break&#8221; statement and a &#8220;default&#8221; case <strong>must</strong> be provided to catch erroneous case values. &#8220;Fall through&#8221; cases are confusing and error-prone and so <strong>should</strong> be made clear in the code.</p>
<blockquote>
<div>Here is an example illustrating several preferred style practices.</div></blockquote>
<div class="highlight-cpp"><div class="highlight"><pre><span class="k">switch</span> <span class="p">(</span><span class="n">condition</span><span class="p">)</span> <span class="p">{</span>

   <span class="k">case</span> <span class="nl">ABC</span> <span class="p">:</span> <span class="p">{</span>
      <span class="p">...</span>
      <span class="k">break</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="k">case</span> <span class="nl">DEF</span> <span class="p">:</span>  <span class="c1">// fall-through case</span>
   <span class="k">case</span> <span class="nl">GHI</span> <span class="p">:</span> <span class="p">{</span>
      <span class="p">...</span>
   <span class="k">break</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="k">default</span> <span class="o">:</span> <span class="p">{</span>
   <span class="p">...</span>
   <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<p>This code example has the following desirable properties:</p>
<blockquote>
<div><ul class="simple">
<li>Curly braces are used for the &#8220;switch&#8221; statement and for each case.</li>
<li>Each &#8220;case&#8221; statement is indented within the &#8220;switch&#8221; statement.</li>
<li>Blank lines are used between different cases.</li>
<li>Each case containing executable statements has a &#8220;break&#8221; statement.</li>
<li>Fall-through case is documented.</li>
<li>A &#8220;default&#8221; case is provided to catch erroneous case values.</li>
</ul>
</div></blockquote>
<p>5.12.7 The &#8220;goto&#8221; statement <strong>should not</strong> be used.</p>
<blockquote>
<div>Only if alternatives are considered and determined to be less desirable,
should a &#8220;goto&#8221; even be contemplated.</div></blockquote>
</div>
<div class="section" id="white-space">
<h2>5.13 White space<a class="headerlink" href="#white-space" title="Permalink to this headline">¶</a></h2>
<p>5.13.1 Blank lines and indentation <strong>should</strong> be used throughout code to enhance readability.</p>
<blockquote>
<div><p>Examples of helpful white space include:</p>
<blockquote>
<div><ul class="simple">
<li>Between operands and operators in arithmetic expressions.</li>
<li>After reserved words, such as &#8220;while&#8221;, &#8220;for&#8221;, &#8220;if&#8221;, &#8220;switch&#8221;, etc.
and before the parenthesis or curly brace that follows.</li>
<li>After commas separating arguments in functions.</li>
<li>After semi-colons in for-loop expressions.</li>
<li>Before and after curly braces in almost all cases.</li>
</ul>
</div></blockquote>
</div></blockquote>
<p>5.13.2 White space <strong>must not</strong> appear between a function name and the opening parenthesis to the argument list.  In particular, if a function call is broken across source lines, the break <strong>must not</strong> come between the function name and the opening parenthesis.</p>
<p>5.13.3 Tabs <strong>must not</strong> be used for indentation since this can be problematic for developers with different text editor settings.</p>
</div>
<div class="section" id="code-alignment">
<h2>5.14 Code alignment<a class="headerlink" href="#code-alignment" title="Permalink to this headline">¶</a></h2>
<p>5.14.1 Each argument in a function declaration or implementation <strong>should</strong> appear on its own line for clarity. The first argument <strong>may</strong> appear on the same line as the function name. When function areguments are placed on multiple lines, they <strong>should</strong> be aligned vertically for clarity.</p>
<p>5.14.2 All statements within a function body <strong>should</strong> be indented within the surrounding curly braces.</p>
<p>5.14.3 The start of all source lines in the same scope <strong>should</strong> be aligned vertically, except for continuations of previous lines.</p>
<p>5.14.4 If a source line is broken at a comma or semi-colon, it <strong>must</strong> be broken after the comma or semi-colon, not before.</p>
<blockquote>
<div>Doing otherwise, produces code that is hard to read and can lead to
errors.</div></blockquote>
<p>5.14.5 If a source line is broken at an arithmetic operator (i.e., , -, etc.), it <strong>should</strong> be broken after the operator, not before.</p>
<blockquote>
<div>Doing otherwise, yields code that is harder to read and can lead to
errors.</div></blockquote>
<p>5.14.6 Parentheses <strong>should</strong> be used in non-trivial mathematical and logical expressions to clearly indicate structure and intended order of operations and to enhance readability.</p>
<blockquote>
<div>Do not assume everyone who looks at the code knows all the rules for
operator precedence.</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">5 General Code Development</a><ul>
<li><a class="reference internal" href="#general-design-and-implementation-considerations">5.1 General design and implementation considerations</a></li>
<li><a class="reference internal" href="#code-robustness">5.2 Code robustness</a></li>
<li><a class="reference internal" href="#compilation-and-portability">5.3 Compilation and portability</a></li>
<li><a class="reference internal" href="#memory-management">5.4 Memory management</a></li>
<li><a class="reference internal" href="#function-declarations">5.5 Function declarations</a></li>
<li><a class="reference internal" href="#function-implementations">5.6 Function implementations</a></li>
<li><a class="reference internal" href="#inline-functions">5.7 Inline functions</a></li>
<li><a class="reference internal" href="#function-and-operator-overloading">5.8 Function and operator overloading</a></li>
<li><a class="reference internal" href="#types">5.9 Types</a></li>
<li><a class="reference internal" href="#type-casting">5.10 Type casting</a></li>
<li><a class="reference internal" href="#templates">5.11 Templates</a></li>
<li><a class="reference internal" href="#conditional-statements-and-loops">5.12 Conditional statements and loops</a></li>
<li><a class="reference internal" href="#white-space">5.13 White space</a></li>
<li><a class="reference internal" href="#code-alignment">5.14 Code alignment</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="Sec4_doc.html"
                        title="previous chapter">4 Code Documentation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="Sec6_class.html"
                        title="next chapter">6 Class Design and Implementation</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/Sec5_code.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="Sec6_class.html" title="6 Class Design and Implementation"
             >next</a> |</li>
        <li class="right" >
          <a href="Sec4_doc.html" title="4 Code Documentation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Toolkit Coding Guidelines 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, Rich Hornung.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>